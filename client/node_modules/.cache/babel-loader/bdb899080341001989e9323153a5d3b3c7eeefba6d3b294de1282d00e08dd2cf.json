{"ast":null,"code":"\"use strict\";\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\n  return typeof obj;\n} : function (obj) {\n  return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n};\nvar querystring = require(\"querystring\");\nvar msgpath = {\n  host: \"rest.nexmo.com\",\n  path: \"/sms/json\"\n};\nvar shortcodePath = {\n  host: \"rest.nexmo.com\",\n  path: \"/sc/us/${type}/json\"\n};\nvar ttsEndpoint = {\n  host: \"api.nexmo.com\",\n  path: \"/tts/json\"\n};\nvar ttsPromptEndpoint = {\n  host: \"api.nexmo.com\",\n  path: \"/tts-prompt/json\"\n};\nvar callEndpoint = {\n  host: \"rest.nexmo.com\",\n  path: \"/call/json\"\n};\nvar verifyEndpoint = {\n  host: \"api.nexmo.com\",\n  path: \"/verify/json\"\n};\nvar checkVerifyEndpoint = {\n  host: \"api.nexmo.com\",\n  path: \"/verify/check/json\"\n};\nvar controlVerifyEndpoint = {\n  host: \"api.nexmo.com\",\n  path: \"/verify/control/json\"\n};\nvar searchVerifyEndpoint = {\n  host: \"api.nexmo.com\",\n  path: \"/verify/search/json\"\n};\nvar niEndpoint = {\n  host: \"api.nexmo.com\",\n  path: \"/ni/advanced/async/json\"\n};\nvar niBasicEndpoint = {\n  host: \"api.nexmo.com\",\n  path: \"/ni/basic/json\"\n};\nvar niStandardEndpoint = {\n  host: \"api.nexmo.com\",\n  path: \"/ni/standard/json\"\n};\nvar niAdvancedEndpoint = {\n  host: \"api.nexmo.com\",\n  path: \"/ni/advanced/json\"\n};\nvar up = {};\nvar numberPattern = new RegExp(\"^[0-9 +()-]*$\");\nvar _options = null;\n\n// Error message resources are maintained globally in one place for easy management\nvar ERROR_MESSAGES = {\n  sender: \"Invalid from address\",\n  to: \"Invalid to address\",\n  msg: \"Invalid Text Message\",\n  msgParams: \"Invalid shortcode message parameters\",\n  countrycode: \"Invalid Country Code\",\n  msisdn: \"Invalid MSISDN passed\",\n  body: \"Invalid Body value in Binary Message\",\n  udh: \"Invalid udh value in Binary Message\",\n  title: \"Invalid title in WAP Push message\",\n  url: \"Invalid url in WAP Push message\",\n  maxDigits: \"Invalid max digits for TTS prompt\",\n  byeText: \"Invalid bye text for TTS prompt\",\n  pinCode: \"Invalid pin code for TTS confirm\",\n  failedText: \"Invalid failed text for TTS confirm\",\n  answerUrl: \"Invalid answer URL for call\",\n  verifyValidation: \"Missing Mandatory fields (number and/or brand)\",\n  checkVerifyValidation: \"Missing Mandatory fields (request_id and/or code)\",\n  controlVerifyValidation: \"Missing Mandatory fields (request_id and/or cmd-command)\",\n  searchVerifyValidation: \"Missing Mandatory fields (request_id or request_ids)\",\n  numberInsightAdvancedValidation: \"Missing Mandatory fields (number and/or callback url)\",\n  numberInsightValidation: \"Missing Mandatory field - number\",\n  numberInsightPatternFailure: \"Number can contain digits and may include any or all of the following: white space, -,+, (, ).\",\n  optionsNotAnObject: \"Options parameter should be a dictionary. Check the docs for valid properties for options\",\n  product: \"Invalid product. Should be one of [voice, sms]\"\n};\nexports.initialize = function (pkey, psecret, options) {\n  // These can default to empty as we may provide a private key for JWT auth\n  // In that situation, private key and secret are not required. If you don't provide\n  // A key/secret and try and make a request you'll get a 401 error back\n  pkey = pkey || \"\";\n  psecret = psecret || \"\";\n  up = {\n    api_key: pkey,\n    api_secret: psecret\n  };\n  _options = options;\n  if (_options.restHost) {\n    msgpath.host = _options.restHost;\n    shortcodePath.host = _options.restHost;\n    callEndpoint.host = _options.restHost;\n  }\n  if (_options.apiHost) {\n    ttsEndpoint.host = _options.apiHost;\n    ttsPromptEndpoint.host = _options.apiHost;\n    verifyEndpoint.host = _options.apiHost;\n    checkVerifyEndpoint.host = _options.apiHost;\n    controlVerifyEndpoint.host = _options.apiHost;\n    searchVerifyEndpoint.host = _options.apiHost;\n    niEndpoint.host = _options.apiHost;\n    niBasicEndpoint.host = _options.apiHost;\n    niStandardEndpoint.host = _options.apiHost;\n    niAdvancedEndpoint.host = _options.apiHost;\n  }\n};\nexports.sendBinaryMessage = function (sender, recipient, body, udh, callback) {\n  if (!body) {\n    sendError(callback, new Error(ERROR_MESSAGES.body));\n  } else if (!udh) {\n    sendError(callback, new Error(ERROR_MESSAGES.udh));\n  } else {\n    sendMessage({\n      from: sender,\n      to: recipient,\n      type: \"binary\",\n      body: body,\n      udh: udh\n    }, callback);\n  }\n};\nexports.sendWapPushMessage = function (sender, recipient, title, url, validity, callback) {\n  if (!title) {\n    sendError(callback, new Error(ERROR_MESSAGES.title));\n  } else if (!url) {\n    sendError(callback, new Error(ERROR_MESSAGES.url));\n  } else {\n    if (typeof validity === \"function\") {\n      callback = validity;\n      validity = 86400000;\n    }\n    sendMessage({\n      from: sender,\n      to: recipient,\n      type: \"wappush\",\n      title: title,\n      validity: validity,\n      url: url\n    }, callback);\n  }\n};\nexports.sendTextMessage = function (sender, recipient, message, opts, callback) {\n  if (!message) {\n    sendError(callback, new Error(ERROR_MESSAGES.msg));\n  } else {\n    if (!callback) {\n      callback = opts;\n      opts = {};\n    }\n    opts[\"from\"] = sender;\n    opts[\"to\"] = recipient;\n    opts[\"text\"] = message;\n    sendMessage(opts, callback);\n  }\n};\nexports.sendMessage = function (opts, callback) {\n  sendMessage(opts, callback);\n};\nfunction sendMessage(data, callback) {\n  if (!data.from) {\n    sendError(callback, new Error(ERROR_MESSAGES.sender));\n  } else if (!data.to) {\n    sendError(callback, new Error(ERROR_MESSAGES.to));\n  } else {\n    var path = clone(msgpath);\n    path.path += \"?\" + querystring.stringify(data);\n    _options.logger.info(\"sending message from \" + data.from + \" to \" + data.to + \" with message \" + data.text);\n    sendRequest(path, \"POST\", function (err, apiResponse) {\n      if (!err && apiResponse.status && apiResponse.messages[0].status > 0) {\n        sendError(callback, new Error(apiResponse.messages[0][\"error-text\"]), apiResponse);\n      } else {\n        if (callback) callback(err, apiResponse);\n      }\n    });\n  }\n}\nfunction sendViaShortcode(type, recipient, messageParams, opts, callback) {\n  if (!recipient) {\n    sendError(callback, new Error(ERROR_MESSAGES.to));\n  }\n  if (!messageParams || !Object.keys(messageParams)) {\n    sendError(callback, new Error(ERROR_MESSAGES.msgParams));\n  }\n  opts = opts || {};\n  var path = clone(shortcodePath);\n  path.path = path.path.replace(\"${type}\", type);\n  Object.keys(messageParams).forEach(function (key) {\n    opts[key] = messageParams[key];\n  });\n  opts.to = recipient;\n  path.path += \"?\" + querystring.stringify(opts);\n  _options.logger.info(\"sending message from shortcode \" + type + \" to \" + recipient + \" with parameters \" + JSON.stringify(messageParams));\n  sendRequest(path, \"POST\", function (err, apiResponse) {\n    if (!err && apiResponse.status && apiResponse.messages[0].status > 0) {\n      sendError(callback, new Error(apiResponse.messages[0][\"error-text\"]), apiResponse);\n    } else {\n      if (callback) callback(err, apiResponse);\n    }\n  });\n}\nexports.shortcodeAlert = function (recipient, messageParams, opts, callback) {\n  sendViaShortcode(\"alert\", recipient, messageParams, opts, callback);\n};\nexports.shortcode2FA = function (recipient, messageParams, opts, callback) {\n  sendViaShortcode(\"2fa\", recipient, messageParams, opts, callback);\n};\nexports.shortcodeMarketing = function (recipient, messageParams, opts, callback) {\n  sendViaShortcode(\"marketing\", recipient, messageParams, opts, callback);\n};\nfunction clone(a) {\n  return JSON.parse(JSON.stringify(a));\n}\nfunction getEndpoint(action) {\n  return {\n    path: action\n  };\n}\nfunction sendRequest(endpoint, method, callback) {\n  endpoint.path = endpoint.path + (endpoint.path.indexOf(\"?\") > 0 ? \"&\" : \"?\") + querystring.stringify(up);\n  _options.httpClient.request(endpoint, method, callback);\n}\nexports.checkBalance = function (callback) {\n  var balanceEndpoint = getEndpoint(\"/account/get-balance\");\n  sendRequest(balanceEndpoint, callback);\n};\nexports.getNumbers = function (options, callback) {\n  var numbersEndpoint = getEndpoint(\"/account/numbers\");\n  if (typeof options === \"function\") {\n    callback = options;\n  } else if ((typeof options === \"undefined\" ? \"undefined\" : _typeof(options)) === \"object\") {\n    numbersEndpoint.path = numbersEndpoint.path + \"?\";\n    for (var key in options) {\n      numbersEndpoint.path = numbersEndpoint.path + key + \"=\" + options[key] + \"&\";\n    }\n  } else {\n    sendError(callback, new Error(ERROR_MESSAGES.optionsNotAnObject));\n    return;\n  }\n  sendRequest(numbersEndpoint, callback);\n};\nexports.searchNumbers = function (countryCode, pattern, callback) {\n  if (!countryCode || countryCode.length !== 2) {\n    sendError(callback, new Error(ERROR_MESSAGES.countrycode));\n  } else {\n    var searchEndpoint = getEndpoint(\"/number/search\");\n    searchEndpoint.path += \"?country=\" + countryCode;\n    if (typeof pattern === \"function\") {\n      callback = pattern;\n    } else if ((typeof pattern === \"undefined\" ? \"undefined\" : _typeof(pattern)) === \"object\") {\n      searchEndpoint.path = searchEndpoint.path + \"&\";\n      for (var arg in pattern) {\n        searchEndpoint.path = searchEndpoint.path + arg + \"=\" + pattern[arg] + \"&\";\n      }\n    } else {\n      searchEndpoint.path = searchEndpoint.path + \"&pattern=\" + pattern;\n    }\n    sendRequest(searchEndpoint, callback);\n  }\n};\nexports.buyNumber = function (countryCode, msisdn, callback) {\n  if (!countryCode || countryCode.length != 2) {\n    sendError(callback, new Error(ERROR_MESSAGES.countrycode));\n  } else if (!msisdn) {\n    sendError(callback, new Error(ERROR_MESSAGES.msisdn));\n  } else {\n    var buyEndpoint = getEndpoint(\"/number/buy\");\n    buyEndpoint.path += \"?country=\" + countryCode + \"&msisdn=\" + msisdn;\n    sendRequest(buyEndpoint, \"POST\", callback);\n  }\n};\nexports.cancelNumber = function (countryCode, msisdn, callback) {\n  if (!countryCode || countryCode.length !== 2) {\n    sendError(callback, new Error(ERROR_MESSAGES.countrycode));\n  } else if (!msisdn) {\n    sendError(callback, new Error(ERROR_MESSAGES.msisdn));\n  } else {\n    var cancelEndpoint = getEndpoint(\"/number/cancel\");\n    cancelEndpoint.path += \"?country=\" + countryCode + \"&msisdn=\" + msisdn;\n    sendRequest(cancelEndpoint, \"POST\", callback);\n  }\n};\nexports.cancelNumber = function (countryCode, msisdn, callback) {\n  if (!countryCode || countryCode.length !== 2) {\n    sendError(callback, new Error(ERROR_MESSAGES.countrycode));\n  } else if (!msisdn) {\n    sendError(callback, new Error(ERROR_MESSAGES.msisdn));\n  } else {\n    var cancelEndpoint = getEndpoint(\"/number/cancel\");\n    cancelEndpoint.path += \"?country=\" + countryCode + \"&msisdn=\" + msisdn;\n    sendRequest(cancelEndpoint, \"POST\", callback);\n  }\n};\nexports.updateNumber = function (countryCode, msisdn, params, callback) {\n  if (!countryCode || countryCode.length !== 2) {\n    sendError(callback, new Error(ERROR_MESSAGES.countrycode));\n  } else if (!msisdn) {\n    sendError(callback, new Error(ERROR_MESSAGES.msisdn));\n  } else {\n    var updateEndpoint = getEndpoint(\"/number/update\");\n    updateEndpoint.path += \"?country=\" + countryCode + \"&msisdn=\" + msisdn;\n    updateEndpoint.path = updateEndpoint.path + \"&\";\n    for (var arg in params) {\n      updateEndpoint.path = updateEndpoint.path + arg + \"=\" + encodeURIComponent(params[arg]) + \"&\";\n    }\n    sendRequest(updateEndpoint, \"POST\", callback);\n  }\n};\nexports.changePassword = function (newSecret, callback) {\n  var settingsEndpoint = getEndpoint(\"/account/settings\");\n  settingsEndpoint.path += \"?newSecret=\" + encodeURIComponent(newSecret);\n  sendRequest(settingsEndpoint, \"POST\", callback);\n};\nexports.changeMoCallbackUrl = function (newUrl, callback) {\n  var settingsEndpoint = getEndpoint(\"/account/settings\");\n  settingsEndpoint.path += \"?moCallBackUrl=\" + encodeURIComponent(newUrl);\n  sendRequest(settingsEndpoint, \"POST\", callback);\n};\nexports.changeDrCallbackUrl = function (newUrl, callback) {\n  var settingsEndpoint = getEndpoint(\"/account/settings\");\n  settingsEndpoint.path += \"?drCallBackUrl=\" + encodeURIComponent(newUrl);\n  sendRequest(settingsEndpoint, \"POST\", callback);\n};\nexports.verifyNumber = function (inputParams, callback) {\n  if (!inputParams.number || !inputParams.brand) {\n    sendError(callback, new Error(ERROR_MESSAGES.verifyValidation));\n  } else {\n    var vEndpoint = clone(verifyEndpoint);\n    vEndpoint.path += \"?\" + querystring.stringify(inputParams);\n    sendRequest(vEndpoint, callback);\n  }\n};\nexports.checkVerifyRequest = function (inputParams, callback) {\n  if (!inputParams.request_id || !inputParams.code) {\n    sendError(callback, new Error(ERROR_MESSAGES.checkVerifyValidation));\n  } else {\n    var vEndpoint = clone(checkVerifyEndpoint);\n    vEndpoint.path += \"?\" + querystring.stringify(inputParams);\n    sendRequest(vEndpoint, callback);\n  }\n};\nexports.controlVerifyRequest = function (inputParams, callback) {\n  if (!inputParams.request_id || !inputParams.cmd) {\n    sendError(callback, new Error(ERROR_MESSAGES.controlVerifyValidation));\n  } else {\n    var vEndpoint = clone(controlVerifyEndpoint);\n    vEndpoint.path += \"?\" + querystring.stringify(inputParams);\n    sendRequest(vEndpoint, callback);\n  }\n};\nexports.searchVerifyRequest = function (requestIds, callback) {\n  var requestIdParam = {};\n  if (!requestIds) {\n    sendError(callback, new Error(ERROR_MESSAGES.searchVerifyValidation));\n  } else {\n    if (Array.isArray(requestIds)) {\n      if (requestIds.length === 1) {\n        requestIdParam.request_id = requestIds;\n      } else {\n        requestIdParam.request_ids = requestIds;\n      }\n    } else {\n      requestIdParam.request_id = requestIds;\n    }\n    var vEndpoint = clone(searchVerifyEndpoint);\n    vEndpoint.path += \"?\" + querystring.stringify(requestIdParam);\n    sendRequest(vEndpoint, callback);\n  }\n};\nexports.numberInsight = function (inputParams, callback) {\n  numberInsightAsync(inputParams, callback);\n};\nexports.numberInsightBasic = function (inputParams, callback) {\n  numberInsightCommon(niBasicEndpoint, inputParams, callback);\n};\nexports.numberInsightStandard = function (inputParams, callback) {\n  numberInsightCommon(niStandardEndpoint, inputParams, callback);\n};\nexports.numberInsightAdvanced = function (inputParams, callback) {\n  numberInsightCommon(niAdvancedEndpoint, inputParams, callback);\n};\nexports.numberInsightAdvancedAsync = function (inputParams, callback) {\n  numberInsightAsync(inputParams, callback);\n};\nfunction numberInsightAsync(inputParams, callback) {\n  if (!inputParams.number || !inputParams.callback) {\n    sendError(callback, new Error(ERROR_MESSAGES.numberInsightAdvancedValidation));\n  } else {\n    var nEndpoint = clone(niEndpoint);\n    nEndpoint.path += \"?\" + querystring.stringify(inputParams);\n    sendRequest(nEndpoint, callback);\n  }\n}\nfunction numberInsightCommon(endpoint, inputParams, callback) {\n  if (validateNumber(inputParams, callback)) {\n    var inputObj;\n    if ((typeof inputParams === \"undefined\" ? \"undefined\" : _typeof(inputParams)) !== \"object\") {\n      inputObj = {\n        number: inputParams\n      };\n    } else {\n      inputObj = inputParams;\n    }\n    var nEndpoint = clone(endpoint);\n    nEndpoint.path += \"?\" + querystring.stringify(inputObj);\n    sendRequest(nEndpoint, callback);\n  }\n}\nfunction validateNumber(inputParams, callback) {\n  if ((typeof inputParams === \"undefined\" ? \"undefined\" : _typeof(inputParams)) === \"object\" && !inputParams.number) {\n    sendError(callback, new Error(ERROR_MESSAGES.numberInsightValidation));\n    return false;\n  } else if ((typeof inputParams === \"undefined\" ? \"undefined\" : _typeof(inputParams)) === \"object\" && !numberPattern.test(inputParams.number)) {\n    sendError(callback, new Error(ERROR_MESSAGES.numberInsightPatternFailure));\n    return false;\n  } else if ((typeof inputParams === \"undefined\" ? \"undefined\" : _typeof(inputParams)) !== \"object\" && (!inputParams || !numberPattern.test(inputParams))) {\n    sendError(callback, new Error(ERROR_MESSAGES.numberInsightPatternFailure));\n    return false;\n  }\n  return true;\n}\nfunction sendVoiceMessage(voiceEndpoint, data, callback) {\n  if (!data.to) {\n    sendError(callback, new Error(ERROR_MESSAGES.to));\n  } else {\n    var endpoint = clone(voiceEndpoint);\n    endpoint.path += \"?\" + querystring.stringify(data);\n    _options.logger.info(\"sending TTS message to \" + data.to + \" with message \" + data.text);\n    sendRequest(endpoint, \"POST\", function (err, apiResponse) {\n      if (!err && apiResponse.status && apiResponse.status > 0) {\n        sendError(callback, new Error(apiResponse[\"error-text\"]), apiResponse);\n      } else {\n        if (callback) callback(err, apiResponse);\n      }\n    });\n  }\n}\nexports.sendTTSMessage = function (recipient, message, opts, callback) {\n  if (!message) {\n    sendError(callback, new Error(ERROR_MESSAGES.msg));\n  } else {\n    if (!opts) {\n      opts = {};\n    }\n    opts[\"to\"] = recipient;\n    opts[\"text\"] = message;\n    sendVoiceMessage(ttsEndpoint, opts, callback);\n  }\n};\nexports.sendTTSPromptWithCapture = function (recipient, message, maxDigits, byeText, opts, callback) {\n  if (!message) {\n    sendError(callback, new Error(ERROR_MESSAGES.msg));\n  } else if (!maxDigits || isNaN(maxDigits) || maxDigits.length > 16) {\n    sendError(callback, new Error(ERROR_MESSAGES.maxDigits));\n  } else if (!byeText) {\n    sendError(callback, new Error(ERROR_MESSAGES.byeText));\n  } else {\n    if (!opts) {\n      opts = {};\n    }\n    opts[\"to\"] = recipient;\n    opts[\"text\"] = message;\n    opts[\"max_digits\"] = maxDigits;\n    opts[\"bye_text\"] = byeText;\n    sendVoiceMessage(ttsPromptEndpoint, opts, callback);\n  }\n};\nexports.sendTTSPromptWithConfirm = function (recipient, message, maxDigits, pinCode, byeText, failedText, opts, callback) {\n  if (!message) {\n    sendError(callback, new Error(ERROR_MESSAGES.msg));\n  } else if (!maxDigits || isNaN(maxDigits) || maxDigits.length > 16) {\n    sendError(callback, new Error(ERROR_MESSAGES.maxDigits));\n  } else if (!pinCode || pinCode.length !== maxDigits) {\n    sendError(callback, new Error(ERROR_MESSAGES.pinCode));\n  } else if (!byeText) {\n    sendError(callback, new Error(ERROR_MESSAGES.byeText));\n  } else if (!failedText) {\n    sendError(callback, new Error(ERROR_MESSAGES.failedText));\n  } else {\n    if (!opts) {\n      opts = {};\n    }\n    opts[\"to\"] = recipient;\n    opts[\"text\"] = message;\n    opts[\"max_digits\"] = maxDigits;\n    opts[\"pin_code\"] = pinCode;\n    opts[\"bye_text\"] = byeText;\n    opts[\"failed_text\"] = failedText;\n    sendVoiceMessage(ttsPromptEndpoint, opts, callback);\n  }\n};\nexports.call = function (recipient, answerUrl, opts, callback) {\n  if (!answerUrl) {\n    sendError(callback, new Error(ERROR_MESSAGES.answerUrl));\n  } else {\n    if (!opts) {\n      opts = {};\n    }\n    opts[\"to\"] = recipient;\n    opts[\"answer_url\"] = answerUrl;\n    sendVoiceMessage(callEndpoint, opts, callback);\n  }\n};\nfunction sendError(callback, err, returnData) {\n  // Throw the error in case if there is no callback passed\n  if (callback) {\n    callback(err, returnData);\n  } else {\n    throw err;\n  }\n}","map":{"version":3,"names":["querystring","require","msgpath","host","path","shortcodePath","ttsEndpoint","ttsPromptEndpoint","callEndpoint","verifyEndpoint","checkVerifyEndpoint","controlVerifyEndpoint","searchVerifyEndpoint","niEndpoint","niBasicEndpoint","niStandardEndpoint","niAdvancedEndpoint","up","numberPattern","RegExp","_options","ERROR_MESSAGES","sender","to","msg","msgParams","countrycode","msisdn","body","udh","title","url","maxDigits","byeText","pinCode","failedText","answerUrl","verifyValidation","checkVerifyValidation","controlVerifyValidation","searchVerifyValidation","numberInsightAdvancedValidation","numberInsightValidation","numberInsightPatternFailure","optionsNotAnObject","product","exports","initialize","pkey","psecret","options","api_key","api_secret","restHost","apiHost","sendBinaryMessage","recipient","callback","sendError","Error","sendMessage","from","type","sendWapPushMessage","validity","sendTextMessage","message","opts","data","clone","stringify","logger","info","text","sendRequest","err","apiResponse","status","messages","sendViaShortcode","messageParams","Object","keys","replace","forEach","key","JSON","shortcodeAlert","shortcode2FA","shortcodeMarketing","a","parse","getEndpoint","action","endpoint","method","indexOf","httpClient","request","checkBalance","balanceEndpoint","getNumbers","numbersEndpoint","_typeof","searchNumbers","countryCode","pattern","length","searchEndpoint","arg","buyNumber","buyEndpoint","cancelNumber","cancelEndpoint","updateNumber","params","updateEndpoint","encodeURIComponent","changePassword","newSecret","settingsEndpoint","changeMoCallbackUrl","newUrl","changeDrCallbackUrl","verifyNumber","inputParams","number","brand","vEndpoint","checkVerifyRequest","request_id","code","controlVerifyRequest","cmd","searchVerifyRequest","requestIds","requestIdParam","Array","isArray","request_ids","numberInsight","numberInsightAsync","numberInsightBasic","numberInsightCommon","numberInsightStandard","numberInsightAdvanced","numberInsightAdvancedAsync","nEndpoint","validateNumber","inputObj","test","sendVoiceMessage","voiceEndpoint","sendTTSMessage","sendTTSPromptWithCapture","isNaN","sendTTSPromptWithConfirm","call","returnData"],"sources":["/Users/vineetkhodre/react-workspace/thoughtctlchatapp/node_modules/nexmo/src/index.js"],"sourcesContent":["\"use strict\";\n\nvar querystring = require(\"querystring\");\n\nvar msgpath = {\n  host: \"rest.nexmo.com\",\n  path: \"/sms/json\"\n};\nvar shortcodePath = {\n  host: \"rest.nexmo.com\",\n  path: \"/sc/us/${type}/json\"\n};\nvar ttsEndpoint = {\n  host: \"api.nexmo.com\",\n  path: \"/tts/json\"\n};\nvar ttsPromptEndpoint = {\n  host: \"api.nexmo.com\",\n  path: \"/tts-prompt/json\"\n};\nvar callEndpoint = {\n  host: \"rest.nexmo.com\",\n  path: \"/call/json\"\n};\nvar verifyEndpoint = {\n  host: \"api.nexmo.com\",\n  path: \"/verify/json\"\n};\nvar checkVerifyEndpoint = {\n  host: \"api.nexmo.com\",\n  path: \"/verify/check/json\"\n};\nvar controlVerifyEndpoint = {\n  host: \"api.nexmo.com\",\n  path: \"/verify/control/json\"\n};\nvar searchVerifyEndpoint = {\n  host: \"api.nexmo.com\",\n  path: \"/verify/search/json\"\n};\nvar niEndpoint = {\n  host: \"api.nexmo.com\",\n  path: \"/ni/advanced/async/json\"\n};\nvar niBasicEndpoint = {\n  host: \"api.nexmo.com\",\n  path: \"/ni/basic/json\"\n};\nvar niStandardEndpoint = {\n  host: \"api.nexmo.com\",\n  path: \"/ni/standard/json\"\n};\nvar niAdvancedEndpoint = {\n  host: \"api.nexmo.com\",\n  path: \"/ni/advanced/json\"\n};\nvar up = {};\nvar numberPattern = new RegExp(\"^[0-9 +()-]*$\");\n\nvar _options = null;\n\n// Error message resources are maintained globally in one place for easy management\nvar ERROR_MESSAGES = {\n  sender: \"Invalid from address\",\n  to: \"Invalid to address\",\n  msg: \"Invalid Text Message\",\n  msgParams: \"Invalid shortcode message parameters\",\n  countrycode: \"Invalid Country Code\",\n  msisdn: \"Invalid MSISDN passed\",\n  body: \"Invalid Body value in Binary Message\",\n  udh: \"Invalid udh value in Binary Message\",\n  title: \"Invalid title in WAP Push message\",\n  url: \"Invalid url in WAP Push message\",\n  maxDigits: \"Invalid max digits for TTS prompt\",\n  byeText: \"Invalid bye text for TTS prompt\",\n  pinCode: \"Invalid pin code for TTS confirm\",\n  failedText: \"Invalid failed text for TTS confirm\",\n  answerUrl: \"Invalid answer URL for call\",\n  verifyValidation: \"Missing Mandatory fields (number and/or brand)\",\n  checkVerifyValidation: \"Missing Mandatory fields (request_id and/or code)\",\n  controlVerifyValidation:\n    \"Missing Mandatory fields (request_id and/or cmd-command)\",\n  searchVerifyValidation:\n    \"Missing Mandatory fields (request_id or request_ids)\",\n  numberInsightAdvancedValidation:\n    \"Missing Mandatory fields (number and/or callback url)\",\n  numberInsightValidation: \"Missing Mandatory field - number\",\n  numberInsightPatternFailure:\n    \"Number can contain digits and may include any or all of the following: white space, -,+, (, ).\",\n  optionsNotAnObject:\n    \"Options parameter should be a dictionary. Check the docs for valid properties for options\",\n  product: \"Invalid product. Should be one of [voice, sms]\"\n};\n\nexports.initialize = function(pkey, psecret, options) {\n  // These can default to empty as we may provide a private key for JWT auth\n  // In that situation, private key and secret are not required. If you don't provide\n  // A key/secret and try and make a request you'll get a 401 error back\n  pkey = pkey || \"\";\n  psecret = psecret || \"\";\n\n  up = {\n    api_key: pkey,\n    api_secret: psecret\n  };\n  _options = options;\n\n  if (_options.restHost) {\n    msgpath.host = _options.restHost;\n    shortcodePath.host = _options.restHost;\n    callEndpoint.host = _options.restHost;\n  }\n\n  if (_options.apiHost) {\n    ttsEndpoint.host = _options.apiHost;\n    ttsPromptEndpoint.host = _options.apiHost;\n    verifyEndpoint.host = _options.apiHost;\n    checkVerifyEndpoint.host = _options.apiHost;\n    controlVerifyEndpoint.host = _options.apiHost;\n    searchVerifyEndpoint.host = _options.apiHost;\n    niEndpoint.host = _options.apiHost;\n    niBasicEndpoint.host = _options.apiHost;\n    niStandardEndpoint.host = _options.apiHost;\n    niAdvancedEndpoint.host = _options.apiHost;\n  }\n};\n\nexports.sendBinaryMessage = function(sender, recipient, body, udh, callback) {\n  if (!body) {\n    sendError(callback, new Error(ERROR_MESSAGES.body));\n  } else if (!udh) {\n    sendError(callback, new Error(ERROR_MESSAGES.udh));\n  } else {\n    sendMessage(\n      {\n        from: sender,\n        to: recipient,\n        type: \"binary\",\n        body: body,\n        udh: udh\n      },\n      callback\n    );\n  }\n};\n\nexports.sendWapPushMessage = function(\n  sender,\n  recipient,\n  title,\n  url,\n  validity,\n  callback\n) {\n  if (!title) {\n    sendError(callback, new Error(ERROR_MESSAGES.title));\n  } else if (!url) {\n    sendError(callback, new Error(ERROR_MESSAGES.url));\n  } else {\n    if (typeof validity === \"function\") {\n      callback = validity;\n      validity = 86400000;\n    }\n    sendMessage(\n      {\n        from: sender,\n        to: recipient,\n        type: \"wappush\",\n        title: title,\n        validity: validity,\n        url: url\n      },\n      callback\n    );\n  }\n};\n\nexports.sendTextMessage = function(sender, recipient, message, opts, callback) {\n  if (!message) {\n    sendError(callback, new Error(ERROR_MESSAGES.msg));\n  } else {\n    if (!callback) {\n      callback = opts;\n      opts = {};\n    }\n    opts[\"from\"] = sender;\n    opts[\"to\"] = recipient;\n    opts[\"text\"] = message;\n    sendMessage(opts, callback);\n  }\n};\n\nexports.sendMessage = function(opts, callback) {\n  sendMessage(opts, callback);\n};\nfunction sendMessage(data, callback) {\n  if (!data.from) {\n    sendError(callback, new Error(ERROR_MESSAGES.sender));\n  } else if (!data.to) {\n    sendError(callback, new Error(ERROR_MESSAGES.to));\n  } else {\n    var path = clone(msgpath);\n    path.path += \"?\" + querystring.stringify(data);\n    _options.logger.info(\n      \"sending message from \" +\n        data.from +\n        \" to \" +\n        data.to +\n        \" with message \" +\n        data.text\n    );\n    sendRequest(path, \"POST\", function(err, apiResponse) {\n      if (!err && apiResponse.status && apiResponse.messages[0].status > 0) {\n        sendError(\n          callback,\n          new Error(apiResponse.messages[0][\"error-text\"]),\n          apiResponse\n        );\n      } else {\n        if (callback) callback(err, apiResponse);\n      }\n    });\n  }\n}\n\nfunction sendViaShortcode(type, recipient, messageParams, opts, callback) {\n  if (!recipient) {\n    sendError(callback, new Error(ERROR_MESSAGES.to));\n  }\n  if (!messageParams || !Object.keys(messageParams)) {\n    sendError(callback, new Error(ERROR_MESSAGES.msgParams));\n  }\n  opts = opts || {};\n  var path = clone(shortcodePath);\n  path.path = path.path.replace(\"${type}\", type);\n  Object.keys(messageParams).forEach(function(key) {\n    opts[key] = messageParams[key];\n  });\n  opts.to = recipient;\n  path.path += \"?\" + querystring.stringify(opts);\n  _options.logger.info(\n    \"sending message from shortcode \" +\n      type +\n      \" to \" +\n      recipient +\n      \" with parameters \" +\n      JSON.stringify(messageParams)\n  );\n  sendRequest(path, \"POST\", function(err, apiResponse) {\n    if (!err && apiResponse.status && apiResponse.messages[0].status > 0) {\n      sendError(\n        callback,\n        new Error(apiResponse.messages[0][\"error-text\"]),\n        apiResponse\n      );\n    } else {\n      if (callback) callback(err, apiResponse);\n    }\n  });\n}\nexports.shortcodeAlert = function(recipient, messageParams, opts, callback) {\n  sendViaShortcode(\"alert\", recipient, messageParams, opts, callback);\n};\nexports.shortcode2FA = function(recipient, messageParams, opts, callback) {\n  sendViaShortcode(\"2fa\", recipient, messageParams, opts, callback);\n};\nexports.shortcodeMarketing = function(\n  recipient,\n  messageParams,\n  opts,\n  callback\n) {\n  sendViaShortcode(\"marketing\", recipient, messageParams, opts, callback);\n};\n\nfunction clone(a) {\n  return JSON.parse(JSON.stringify(a));\n}\n\nfunction getEndpoint(action) {\n  return { path: action };\n}\n\nfunction sendRequest(endpoint, method, callback) {\n  endpoint.path =\n    endpoint.path +\n    (endpoint.path.indexOf(\"?\") > 0 ? \"&\" : \"?\") +\n    querystring.stringify(up);\n  _options.httpClient.request(endpoint, method, callback);\n}\n\nexports.checkBalance = function(callback) {\n  var balanceEndpoint = getEndpoint(\"/account/get-balance\");\n  sendRequest(balanceEndpoint, callback);\n};\n\nexports.getNumbers = function(options, callback) {\n  var numbersEndpoint = getEndpoint(\"/account/numbers\");\n  if (typeof options === \"function\") {\n    callback = options;\n  } else if (typeof options === \"object\") {\n    numbersEndpoint.path = numbersEndpoint.path + \"?\";\n    for (var key in options) {\n      numbersEndpoint.path =\n        numbersEndpoint.path + key + \"=\" + options[key] + \"&\";\n    }\n  } else {\n    sendError(callback, new Error(ERROR_MESSAGES.optionsNotAnObject));\n    return;\n  }\n  sendRequest(numbersEndpoint, callback);\n};\n\nexports.searchNumbers = function(countryCode, pattern, callback) {\n  if (!countryCode || countryCode.length !== 2) {\n    sendError(callback, new Error(ERROR_MESSAGES.countrycode));\n  } else {\n    var searchEndpoint = getEndpoint(\"/number/search\");\n    searchEndpoint.path += \"?country=\" + countryCode;\n    if (typeof pattern === \"function\") {\n      callback = pattern;\n    } else if (typeof pattern === \"object\") {\n      searchEndpoint.path = searchEndpoint.path + \"&\";\n      for (var arg in pattern) {\n        searchEndpoint.path =\n          searchEndpoint.path + arg + \"=\" + pattern[arg] + \"&\";\n      }\n    } else {\n      searchEndpoint.path = searchEndpoint.path + \"&pattern=\" + pattern;\n    }\n    sendRequest(searchEndpoint, callback);\n  }\n};\n\nexports.buyNumber = function(countryCode, msisdn, callback) {\n  if (!countryCode || countryCode.length != 2) {\n    sendError(callback, new Error(ERROR_MESSAGES.countrycode));\n  } else if (!msisdn) {\n    sendError(callback, new Error(ERROR_MESSAGES.msisdn));\n  } else {\n    var buyEndpoint = getEndpoint(\"/number/buy\");\n    buyEndpoint.path += \"?country=\" + countryCode + \"&msisdn=\" + msisdn;\n    sendRequest(buyEndpoint, \"POST\", callback);\n  }\n};\n\nexports.cancelNumber = function(countryCode, msisdn, callback) {\n  if (!countryCode || countryCode.length !== 2) {\n    sendError(callback, new Error(ERROR_MESSAGES.countrycode));\n  } else if (!msisdn) {\n    sendError(callback, new Error(ERROR_MESSAGES.msisdn));\n  } else {\n    var cancelEndpoint = getEndpoint(\"/number/cancel\");\n    cancelEndpoint.path += \"?country=\" + countryCode + \"&msisdn=\" + msisdn;\n    sendRequest(cancelEndpoint, \"POST\", callback);\n  }\n};\n\nexports.cancelNumber = function(countryCode, msisdn, callback) {\n  if (!countryCode || countryCode.length !== 2) {\n    sendError(callback, new Error(ERROR_MESSAGES.countrycode));\n  } else if (!msisdn) {\n    sendError(callback, new Error(ERROR_MESSAGES.msisdn));\n  } else {\n    var cancelEndpoint = getEndpoint(\"/number/cancel\");\n    cancelEndpoint.path += \"?country=\" + countryCode + \"&msisdn=\" + msisdn;\n    sendRequest(cancelEndpoint, \"POST\", callback);\n  }\n};\n\nexports.updateNumber = function(countryCode, msisdn, params, callback) {\n  if (!countryCode || countryCode.length !== 2) {\n    sendError(callback, new Error(ERROR_MESSAGES.countrycode));\n  } else if (!msisdn) {\n    sendError(callback, new Error(ERROR_MESSAGES.msisdn));\n  } else {\n    var updateEndpoint = getEndpoint(\"/number/update\");\n    updateEndpoint.path += \"?country=\" + countryCode + \"&msisdn=\" + msisdn;\n    updateEndpoint.path = updateEndpoint.path + \"&\";\n    for (var arg in params) {\n      updateEndpoint.path =\n        updateEndpoint.path + arg + \"=\" + encodeURIComponent(params[arg]) + \"&\";\n    }\n    sendRequest(updateEndpoint, \"POST\", callback);\n  }\n};\n\nexports.changePassword = function(newSecret, callback) {\n  var settingsEndpoint = getEndpoint(\"/account/settings\");\n  settingsEndpoint.path += \"?newSecret=\" + encodeURIComponent(newSecret);\n  sendRequest(settingsEndpoint, \"POST\", callback);\n};\n\nexports.changeMoCallbackUrl = function(newUrl, callback) {\n  var settingsEndpoint = getEndpoint(\"/account/settings\");\n  settingsEndpoint.path += \"?moCallBackUrl=\" + encodeURIComponent(newUrl);\n  sendRequest(settingsEndpoint, \"POST\", callback);\n};\n\nexports.changeDrCallbackUrl = function(newUrl, callback) {\n  var settingsEndpoint = getEndpoint(\"/account/settings\");\n  settingsEndpoint.path += \"?drCallBackUrl=\" + encodeURIComponent(newUrl);\n  sendRequest(settingsEndpoint, \"POST\", callback);\n};\n\nexports.verifyNumber = function(inputParams, callback) {\n  if (!inputParams.number || !inputParams.brand) {\n    sendError(callback, new Error(ERROR_MESSAGES.verifyValidation));\n  } else {\n    var vEndpoint = clone(verifyEndpoint);\n    vEndpoint.path += \"?\" + querystring.stringify(inputParams);\n    sendRequest(vEndpoint, callback);\n  }\n};\n\nexports.checkVerifyRequest = function(inputParams, callback) {\n  if (!inputParams.request_id || !inputParams.code) {\n    sendError(callback, new Error(ERROR_MESSAGES.checkVerifyValidation));\n  } else {\n    var vEndpoint = clone(checkVerifyEndpoint);\n    vEndpoint.path += \"?\" + querystring.stringify(inputParams);\n    sendRequest(vEndpoint, callback);\n  }\n};\n\nexports.controlVerifyRequest = function(inputParams, callback) {\n  if (!inputParams.request_id || !inputParams.cmd) {\n    sendError(callback, new Error(ERROR_MESSAGES.controlVerifyValidation));\n  } else {\n    var vEndpoint = clone(controlVerifyEndpoint);\n    vEndpoint.path += \"?\" + querystring.stringify(inputParams);\n    sendRequest(vEndpoint, callback);\n  }\n};\n\nexports.searchVerifyRequest = function(requestIds, callback) {\n  var requestIdParam = {};\n  if (!requestIds) {\n    sendError(callback, new Error(ERROR_MESSAGES.searchVerifyValidation));\n  } else {\n    if (Array.isArray(requestIds)) {\n      if (requestIds.length === 1) {\n        requestIdParam.request_id = requestIds;\n      } else {\n        requestIdParam.request_ids = requestIds;\n      }\n    } else {\n      requestIdParam.request_id = requestIds;\n    }\n    var vEndpoint = clone(searchVerifyEndpoint);\n    vEndpoint.path += \"?\" + querystring.stringify(requestIdParam);\n    sendRequest(vEndpoint, callback);\n  }\n};\n\nexports.numberInsight = function(inputParams, callback) {\n  numberInsightAsync(inputParams, callback);\n};\n\nexports.numberInsightBasic = function(inputParams, callback) {\n  numberInsightCommon(niBasicEndpoint, inputParams, callback);\n};\n\nexports.numberInsightStandard = function(inputParams, callback) {\n  numberInsightCommon(niStandardEndpoint, inputParams, callback);\n};\n\nexports.numberInsightAdvanced = function(inputParams, callback) {\n  numberInsightCommon(niAdvancedEndpoint, inputParams, callback);\n};\n\nexports.numberInsightAdvancedAsync = function(inputParams, callback) {\n  numberInsightAsync(inputParams, callback);\n};\n\nfunction numberInsightAsync(inputParams, callback) {\n  if (!inputParams.number || !inputParams.callback) {\n    sendError(\n      callback,\n      new Error(ERROR_MESSAGES.numberInsightAdvancedValidation)\n    );\n  } else {\n    var nEndpoint = clone(niEndpoint);\n    nEndpoint.path += \"?\" + querystring.stringify(inputParams);\n    sendRequest(nEndpoint, callback);\n  }\n}\n\nfunction numberInsightCommon(endpoint, inputParams, callback) {\n  if (validateNumber(inputParams, callback)) {\n    var inputObj;\n    if (typeof inputParams !== \"object\") {\n      inputObj = { number: inputParams };\n    } else {\n      inputObj = inputParams;\n    }\n    var nEndpoint = clone(endpoint);\n    nEndpoint.path += \"?\" + querystring.stringify(inputObj);\n    sendRequest(nEndpoint, callback);\n  }\n}\nfunction validateNumber(inputParams, callback) {\n  if (typeof inputParams === \"object\" && !inputParams.number) {\n    sendError(callback, new Error(ERROR_MESSAGES.numberInsightValidation));\n    return false;\n  } else if (\n    typeof inputParams === \"object\" &&\n    !numberPattern.test(inputParams.number)\n  ) {\n    sendError(callback, new Error(ERROR_MESSAGES.numberInsightPatternFailure));\n    return false;\n  } else if (\n    typeof inputParams !== \"object\" &&\n    (!inputParams || !numberPattern.test(inputParams))\n  ) {\n    sendError(callback, new Error(ERROR_MESSAGES.numberInsightPatternFailure));\n    return false;\n  }\n  return true;\n}\n\nfunction sendVoiceMessage(voiceEndpoint, data, callback) {\n  if (!data.to) {\n    sendError(callback, new Error(ERROR_MESSAGES.to));\n  } else {\n    var endpoint = clone(voiceEndpoint);\n    endpoint.path += \"?\" + querystring.stringify(data);\n    _options.logger.info(\n      \"sending TTS message to \" + data.to + \" with message \" + data.text\n    );\n    sendRequest(endpoint, \"POST\", function(err, apiResponse) {\n      if (!err && apiResponse.status && apiResponse.status > 0) {\n        sendError(callback, new Error(apiResponse[\"error-text\"]), apiResponse);\n      } else {\n        if (callback) callback(err, apiResponse);\n      }\n    });\n  }\n}\n\nexports.sendTTSMessage = function(recipient, message, opts, callback) {\n  if (!message) {\n    sendError(callback, new Error(ERROR_MESSAGES.msg));\n  } else {\n    if (!opts) {\n      opts = {};\n    }\n    opts[\"to\"] = recipient;\n    opts[\"text\"] = message;\n    sendVoiceMessage(ttsEndpoint, opts, callback);\n  }\n};\n\nexports.sendTTSPromptWithCapture = function(\n  recipient,\n  message,\n  maxDigits,\n  byeText,\n  opts,\n  callback\n) {\n  if (!message) {\n    sendError(callback, new Error(ERROR_MESSAGES.msg));\n  } else if (!maxDigits || isNaN(maxDigits) || maxDigits.length > 16) {\n    sendError(callback, new Error(ERROR_MESSAGES.maxDigits));\n  } else if (!byeText) {\n    sendError(callback, new Error(ERROR_MESSAGES.byeText));\n  } else {\n    if (!opts) {\n      opts = {};\n    }\n    opts[\"to\"] = recipient;\n    opts[\"text\"] = message;\n    opts[\"max_digits\"] = maxDigits;\n    opts[\"bye_text\"] = byeText;\n    sendVoiceMessage(ttsPromptEndpoint, opts, callback);\n  }\n};\n\nexports.sendTTSPromptWithConfirm = function(\n  recipient,\n  message,\n  maxDigits,\n  pinCode,\n  byeText,\n  failedText,\n  opts,\n  callback\n) {\n  if (!message) {\n    sendError(callback, new Error(ERROR_MESSAGES.msg));\n  } else if (!maxDigits || isNaN(maxDigits) || maxDigits.length > 16) {\n    sendError(callback, new Error(ERROR_MESSAGES.maxDigits));\n  } else if (!pinCode || pinCode.length !== maxDigits) {\n    sendError(callback, new Error(ERROR_MESSAGES.pinCode));\n  } else if (!byeText) {\n    sendError(callback, new Error(ERROR_MESSAGES.byeText));\n  } else if (!failedText) {\n    sendError(callback, new Error(ERROR_MESSAGES.failedText));\n  } else {\n    if (!opts) {\n      opts = {};\n    }\n    opts[\"to\"] = recipient;\n    opts[\"text\"] = message;\n    opts[\"max_digits\"] = maxDigits;\n    opts[\"pin_code\"] = pinCode;\n    opts[\"bye_text\"] = byeText;\n    opts[\"failed_text\"] = failedText;\n    sendVoiceMessage(ttsPromptEndpoint, opts, callback);\n  }\n};\n\nexports.call = function(recipient, answerUrl, opts, callback) {\n  if (!answerUrl) {\n    sendError(callback, new Error(ERROR_MESSAGES.answerUrl));\n  } else {\n    if (!opts) {\n      opts = {};\n    }\n    opts[\"to\"] = recipient;\n    opts[\"answer_url\"] = answerUrl;\n    sendVoiceMessage(callEndpoint, opts, callback);\n  }\n};\n\nfunction sendError(callback, err, returnData) {\n  // Throw the error in case if there is no callback passed\n  if (callback) {\n    callback(err, returnData);\n  } else {\n    throw err;\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}